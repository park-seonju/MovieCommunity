{"remainingRequest":"C:\\Users\\user\\Desktop\\my_project\\FinalPJT\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\user\\Desktop\\my_project\\FinalPJT\\client\\src\\components\\Modal.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\user\\Desktop\\my_project\\FinalPJT\\client\\src\\components\\Modal.vue","mtime":1622083269647},{"path":"C:\\Users\\user\\Desktop\\my_project\\FinalPJT\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\user\\Desktop\\my_project\\FinalPJT\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\user\\Desktop\\my_project\\FinalPJT\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\user\\Desktop\\my_project\\FinalPJT\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnDQpjb25zdCBCQVNFX1VSTCA9ICJodHRwczovL3d3dy55b3V0dWJlLmNvbS9lbWJlZC8iDQpleHBvcnQgZGVmYXVsdCB7DQogIHByb3BzOnsNCiAgICBtb3ZpZTp7DQogICAgICB0eXBlOiBPYmplY3QsDQogICAgfSwNCiAgICBtb2RhbE5hbWU6ew0KICAgICAgdHlwZTogU3RyaW5nLA0KICAgIH0sDQogIH0sDQogIGRhdGEoKXsNCiAgICByZXR1cm4gew0KICAgICAgdXJsOiAnJywNCiAgICAgIHJldmlld0xpc3Q6IFtdLA0KICAgICAgbGlrZTogZmFsc2UsDQogICAgfQ0KICB9LA0KICBtZXRob2RzOnsNCiAgICBvbkNsaWNrKCl7DQogICAgICBjb25zdCBtb3ZpZV9pZCA9IHRoaXMubW92aWUubW92aWVfaWQNCiAgICAgIGlmKHRoaXMubW9kYWxOYW1lICE9PSAndG9wUmF0ZScpew0KICAgICAgICBheGlvcyh7DQogICAgICAgICAgbWV0aG9kOiAnZ2V0JywNCiAgICAgICAgICB1cmw6YGh0dHA6Ly8xMjcuMC4wLjE6ODAwMC9tb3ZpZXMvbGlrZS8ke21vdmllX2lkfS9gLA0KICAgICAgICAgIGhlYWRlcnM6IHsNCiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBKV1QgJHtsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnand0Jyl9YCwgDQogICAgICAgICAgfSwNCiAgICAgICAgfSkNCiAgICAgICAgICAudGhlbigocmVzKT0+ew0KICAgICAgICAgIGlmIChyZXMuZGF0YS5saWtlKQ0KICAgICAgICAgICAgdGhpcy5saWtlID0gdHJ1ZQ0KICAgICAgICB9KS5jYXRjaCgoZSk9PnsNCiAgICAgICAgICBjb25zb2xlLmxvZyhlKQ0KICAgICAgICB9KQ0KICAgICAgfQ0KDQogICAgICBjb25zdCBBUElfS0VZID0gJzYyYTAyZTc3NmU0YmQwYTIzZDU0OTg4YWFkY2ZkZTAxJw0KICAgICAgY29uc3QgcGFyYW1zID0gew0KICAgICAgICBtZXRob2Q6ICdnZXQnLA0KICAgICAgICB1cmw6YGh0dHBzOi8vYXBpLnRoZW1vdmllZGIub3JnLzMvbW92aWUvJHttb3ZpZV9pZH0vdmlkZW9zP2FwaV9rZXk9JHtBUElfS0VZfSZsYW5ndWFnZT1rby1LUmANCiAgICAgIH0NCiAgICAgIGF4aW9zKHBhcmFtcykNCiAgICAgICAgLnRoZW4oKHJlcyk9PnsNCiAgICAgICAgY29uc3QgdmlkZW9MaXN0ID0gcmVzLmRhdGEucmVzdWx0cw0KICAgICAgICBpZiAodmlkZW9MaXN0Lmxlbmd0aCA+IDApew0KICAgICAgICAgIGZvciAobGV0IHZpZGVvIG9mIHZpZGVvTGlzdCl7DQogICAgICAgICAgICBpZiAodmlkZW8udHlwZT09PSJUcmFpbGVyIikNCiAgICAgICAgICAgICAgdGhpcy51cmwgPSBCQVNFX1VSTCArIHZpZGVvLmtleSArJz9hdXRvcGxheT0xJw0KICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICB9DQogICAgICAgICAgaWYgKHRoaXMudXJsPT09JycpDQogICAgICAgICAgICB0aGlzLnVybCA9IEJBU0VfVVJMICsgdmlkZW9MaXN0WzBdLmtleSArJz9hdXRvcGxheT0xJw0KICAgICAgICB9DQogICAgICAgIGVsc2V7DQogICAgICAgICAgY29uc3QgWU9VVFVCRV9BUElfS0VZID0gJ0FJemFTeUJNYVJBZDZRdVF5ejF2cmlVblYyNXJFWUkwMTNzTFBaWScNCiAgICAgICAgICBjb25zdCB5b3V0dWJlX2NvbmZpZyA9IHsNCiAgICAgICAgICAgIG1ldGhvZDogJ2dldCcsDQogICAgICAgICAgICB1cmw6ICdodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS95b3V0dWJlL3YzL3NlYXJjaCcsDQogICAgICAgICAgICBwYXJhbXM6ew0KICAgICAgICAgICAgICBrZXk6IFlPVVRVQkVfQVBJX0tFWSwNCiAgICAgICAgICAgICAgcGFydDogJ3NuaXBwZXQnLA0KICAgICAgICAgICAgICB0eXBlOiAndmlkZW8nLA0KICAgICAgICAgICAgICBxOiB0aGlzLm1vdmllVGl0bGUsDQogICAgICAgICAgICAgIG1heFJlc3VsdHM6IDEsDQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICAgIGF4aW9zKHlvdXR1YmVfY29uZmlnKQ0KICAgICAgICAgICAgLnRoZW4oKHJlcyk9PnsNCiAgICAgICAgICAgICAgdGhpcy51cmwgPSBCQVNFX1VSTCArIHJlcy5kYXRhLml0ZW1zWzBdLmlkLnZpZGVvSWQgKyc/YXV0b3BsYXk9MScNCiAgICAgICAgICB9KS5jYXRjaChlPT57DQogICAgICAgICAgICBjb25zb2xlLmxvZyhlKQ0KICAgICAgICAgIH0pDQogICAgICAgIH0NCiAgICAgIH0pLmNhdGNoKChlKT0+ew0KICAgICAgICBjb25zb2xlLmxvZyhlKQ0KICAgICAgfSkNCiAgICAgIGNvbnN0IHBhcmFtczIgPSB7IA0KICAgICAgICBtZXRob2Q6ICdnZXQnLA0KICAgICAgICB1cmw6YGh0dHA6Ly8xMjcuMC4wLjE6ODAwMC9yZXZpZXcvJHttb3ZpZV9pZH0vYCwNCiAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgIEF1dGhvcml6YXRpb246IGBKV1QgJHtsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnand0Jyl9YCwgDQogICAgICAgIH0sDQogICAgICB9DQogICAgICBpZih0aGlzLm1vZGFsTmFtZSAhPT0gJ3RvcFJhdGUnKXsNCiAgICAgICAgYXhpb3MocGFyYW1zMikNCiAgICAgICAgICAudGhlbigocmVzKT0+ew0KICAgICAgICAgIHRoaXMucmV2aWV3TGlzdCA9IHJlcy5kYXRhDQogICAgICAgIH0pLmNhdGNoKChlKT0+ew0KICAgICAgICAgIGNvbnNvbGUubG9nKGUpDQogICAgICAgIH0pDQogICAgICB9DQogICAgfSwNCiAgICBjcmVhdGVSZXZpZXcoKXsNCiAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLnNlbGVjdE1vdmllID0gdGhpcy5tb3ZpZQ0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goe25hbWU6J0NyZWF0ZVJldmlldyd9KQ0KICAgIH0sDQogICAgbGlrZVRvZ2dsZSgpew0KICAgICAgY29uc3QgbW92aWVfaWQgPSB0aGlzLm1vdmllLm1vdmllX2lkDQogICAgICBjb25zdCBwYXJhbXMgPSB7DQogICAgICAgIG1ldGhvZDogJ3Bvc3QnLA0KICAgICAgICB1cmw6YGh0dHA6Ly8xMjcuMC4wLjE6ODAwMC9tb3ZpZXMvbGlrZS8ke21vdmllX2lkfS9gLA0KICAgICAgICBoZWFkZXJzOiB7DQogICAgICAgICAgQXV0aG9yaXphdGlvbjogYEpXVCAke2xvY2FsU3RvcmFnZS5nZXRJdGVtKCdqd3QnKX1gLCANCiAgICAgICAgfSwNCiAgICAgIH0NCiAgICAgIGF4aW9zKHBhcmFtcykNCiAgICAgICAgLnRoZW4oKHJlcyk9PnsNCiAgICAgICAgaWYgKHJlcy5kYXRhLmxpa2UpDQogICAgICAgICAgdGhpcy5saWtlID0gdHJ1ZQ0KICAgICAgICBlbHNlDQogICAgICAgICAgdGhpcy5saWtlID0gZmFsc2UNCiAgICAgIH0pLmNhdGNoKChlKT0+ew0KICAgICAgICBjb25zb2xlLmxvZyhlKQ0KICAgICAgfSkNCiAgICB9LA0KICAgIG1vdmVSZXZpZXcocmV2aWV3KXsNCiAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLnNlbGVjdFJldmlldyA9IHJldmlldw0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goe25hbWU6ICdSZXZpZXdEZXRhaWwnfSkNCiAgICB9DQogIH0sDQogIGNvbXB1dGVkOnsNCiAgICBtb3ZpZVRpdGxlKCl7DQogICAgICByZXR1cm4gdGhpcy5tb3ZpZS50aXRsZQ0KICAgIH0sDQogICAgbW92aWVJZCgpew0KICAgICAgcmV0dXJuIHRoaXMubW92aWUubW92aWVfaWQNCiAgICB9LA0KICAgIG1vdmllUG9zdGVyKCl7DQogICAgICByZXR1cm4gImh0dHBzOi8vaW1hZ2UudG1kYi5vcmcvdC9wL3c1MDAvIiArIHRoaXMubW92aWUucG9zdGVyX3BhdGgNCiAgICB9LA0KICAgIG1vdmllT3ZlcnZpZXcoKXsNCiAgICAgIHJldHVybiB0aGlzLm1vdmllLm92ZXJ2aWV3DQogICAgfSwNCiAgICBtb3ZpZVJlbGVhc2VEYXRlKCl7DQogICAgICByZXR1cm4gdGhpcy5tb3ZpZS5yZWxlYXNlX2RhdGUNCiAgICB9LA0KICAgIG1vdmllVm90ZUF2ZXJhZ2UoKXsNCiAgICAgIHJldHVybiB0aGlzLm1vdmllLnZvdGVfYXZlcmFnZQ0KICAgIH0sDQogICAgbW92aWVHZW5yZXMoKXsNCiAgICAgIGNvbnN0IGdlbnJlX3RleHRfbGlzdCA9IFtdDQogICAgICB0aGlzLm1vdmllLmdlbnJlX2lkcy5zcGxpdCgnLCcpLmZvckVhY2goKGdlbnJlKT0+ew0KICAgICAgICBpZiAoZ2VucmUpDQogICAgICAgICAgZ2VucmVfdGV4dF9saXN0LnB1c2godGhpcy4kc3RvcmUuc3RhdGUuZ2VucmVzW051bWJlcihnZW5yZSldKQ0KICAgICAgfSkNCiAgICAgIHJldHVybiBnZW5yZV90ZXh0X2xpc3Quam9pbignLCAnKQ0KICAgIH0sDQogICAgaXNOb3RUb3BSYXRlKCl7DQogICAgICBpZiAodGhpcy5tb2RhbE5hbWUgPT09ICd0b3BSYXRlJykgDQogICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgcmV0dXJuIHRydWUNCiAgICB9DQogIH0sDQoNCiAgDQp9DQo="},{"version":3,"sources":["Modal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA","file":"Modal.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <b-modal size=\"xl\"\r\n    :id=\"'myModal'+modalName+movieId\" :title=\"movieTitle\" \r\n    @show=\"onClick\"\r\n    hide-header-close\r\n  >\r\n    <div>\r\n      <div class=\"d-flex flex-wrap justify-content-stretch\">\r\n        <!-- 영화 포스터 -->\r\n        <b-col class=\"p-3 col-12 col-lg-4\">\r\n          <img style=\"width:100%\"\r\n            :src=\"moviePoster\" :alt=\"movieTitle+'poster'\"\r\n          >\r\n        </b-col>\r\n        <b-col class=\"p-3 col-12 col-lg-8\">\r\n          <div class=\"wrapper\">\r\n            <!-- 영화 관련 -->\r\n            <iframe class=\"player\"\r\n              id=\"ytplayer\" type=\"text/html\" \r\n              :src=\"this.url\"\r\n              frameborder=\"0\">\r\n            </iframe>\r\n          </div>\r\n          <div>\r\n            <h3>\r\n              {{movieTitle}}\r\n              <b-button class=\"bg-light\" @click=\"likeToggle\" v-if=\"isNotTopRate\">\r\n                <span v-if=\"like\">\r\n                  <font-awesome-icon :icon=\"['fas','heart']\" :style=\"{color : 'red'}\" />\r\n                </span>\r\n                <span v-else>\r\n                  <font-awesome-icon :icon=\"['far','heart']\" :style=\"{color : 'black'}\"/>\r\n                </span>\r\n              </b-button>\r\n            </h3>\r\n          </div>\r\n\r\n          <div>\r\n            <p><strong>줄거리</strong></p>\r\n            <p style=\"font-family: 'Nanum Gothic', sans-serif;\">{{movieOverview}}</p>\r\n          </div>\r\n          <p><strong>개봉일:</strong> {{movieReleaseDate}}</p>\r\n          <p><strong>평점:</strong> {{movieVoteAverage}}</p>\r\n          <div v-if=\"isNotTopRate\">\r\n            <p><strong>리뷰:</strong></p>\r\n            <p v-for=\"review in reviewList\" :key=\"review.id\" \r\n              style=\"font-family: 'Nanum Gothic', sans-serif;\"> \r\n              <a href=\"#\" @click.prevent=\"moveReview(review)\">\r\n                - {{review.title}}\r\n              </a>\r\n\r\n            </p>\r\n            <button class=\"btn btn-outline-primary\" @click=\"createReview\">리뷰 작성</button>\r\n          </div>\r\n        </b-col>\r\n      </div>\r\n    </div>\r\n  </b-modal>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nconst BASE_URL = \"https://www.youtube.com/embed/\"\r\nexport default {\r\n  props:{\r\n    movie:{\r\n      type: Object,\r\n    },\r\n    modalName:{\r\n      type: String,\r\n    },\r\n  },\r\n  data(){\r\n    return {\r\n      url: '',\r\n      reviewList: [],\r\n      like: false,\r\n    }\r\n  },\r\n  methods:{\r\n    onClick(){\r\n      const movie_id = this.movie.movie_id\r\n      if(this.modalName !== 'topRate'){\r\n        axios({\r\n          method: 'get',\r\n          url:`http://127.0.0.1:8000/movies/like/${movie_id}/`,\r\n          headers: {\r\n            Authorization: `JWT ${localStorage.getItem('jwt')}`, \r\n          },\r\n        })\r\n          .then((res)=>{\r\n          if (res.data.like)\r\n            this.like = true\r\n        }).catch((e)=>{\r\n          console.log(e)\r\n        })\r\n      }\r\n\r\n      const API_KEY = '62a02e776e4bd0a23d54988aadcfde01'\r\n      const params = {\r\n        method: 'get',\r\n        url:`https://api.themoviedb.org/3/movie/${movie_id}/videos?api_key=${API_KEY}&language=ko-KR`\r\n      }\r\n      axios(params)\r\n        .then((res)=>{\r\n        const videoList = res.data.results\r\n        if (videoList.length > 0){\r\n          for (let video of videoList){\r\n            if (video.type===\"Trailer\")\r\n              this.url = BASE_URL + video.key +'?autoplay=1'\r\n            break\r\n          }\r\n          if (this.url==='')\r\n            this.url = BASE_URL + videoList[0].key +'?autoplay=1'\r\n        }\r\n        else{\r\n          const YOUTUBE_API_KEY = 'AIzaSyBMaRAd6QuQyz1vriUnV25rEYI013sLPZY'\r\n          const youtube_config = {\r\n            method: 'get',\r\n            url: 'https://www.googleapis.com/youtube/v3/search',\r\n            params:{\r\n              key: YOUTUBE_API_KEY,\r\n              part: 'snippet',\r\n              type: 'video',\r\n              q: this.movieTitle,\r\n              maxResults: 1,\r\n            }\r\n          }\r\n          axios(youtube_config)\r\n            .then((res)=>{\r\n              this.url = BASE_URL + res.data.items[0].id.videoId +'?autoplay=1'\r\n          }).catch(e=>{\r\n            console.log(e)\r\n          })\r\n        }\r\n      }).catch((e)=>{\r\n        console.log(e)\r\n      })\r\n      const params2 = { \r\n        method: 'get',\r\n        url:`http://127.0.0.1:8000/review/${movie_id}/`,\r\n        headers: {\r\n          Authorization: `JWT ${localStorage.getItem('jwt')}`, \r\n        },\r\n      }\r\n      if(this.modalName !== 'topRate'){\r\n        axios(params2)\r\n          .then((res)=>{\r\n          this.reviewList = res.data\r\n        }).catch((e)=>{\r\n          console.log(e)\r\n        })\r\n      }\r\n    },\r\n    createReview(){\r\n      this.$store.state.selectMovie = this.movie\r\n      this.$router.push({name:'CreateReview'})\r\n    },\r\n    likeToggle(){\r\n      const movie_id = this.movie.movie_id\r\n      const params = {\r\n        method: 'post',\r\n        url:`http://127.0.0.1:8000/movies/like/${movie_id}/`,\r\n        headers: {\r\n          Authorization: `JWT ${localStorage.getItem('jwt')}`, \r\n        },\r\n      }\r\n      axios(params)\r\n        .then((res)=>{\r\n        if (res.data.like)\r\n          this.like = true\r\n        else\r\n          this.like = false\r\n      }).catch((e)=>{\r\n        console.log(e)\r\n      })\r\n    },\r\n    moveReview(review){\r\n      this.$store.state.selectReview = review\r\n      this.$router.push({name: 'ReviewDetail'})\r\n    }\r\n  },\r\n  computed:{\r\n    movieTitle(){\r\n      return this.movie.title\r\n    },\r\n    movieId(){\r\n      return this.movie.movie_id\r\n    },\r\n    moviePoster(){\r\n      return \"https://image.tmdb.org/t/p/w500/\" + this.movie.poster_path\r\n    },\r\n    movieOverview(){\r\n      return this.movie.overview\r\n    },\r\n    movieReleaseDate(){\r\n      return this.movie.release_date\r\n    },\r\n    movieVoteAverage(){\r\n      return this.movie.vote_average\r\n    },\r\n    movieGenres(){\r\n      const genre_text_list = []\r\n      this.movie.genre_ids.split(',').forEach((genre)=>{\r\n        if (genre)\r\n          genre_text_list.push(this.$store.state.genres[Number(genre)])\r\n      })\r\n      return genre_text_list.join(', ')\r\n    },\r\n    isNotTopRate(){\r\n      if (this.modalName === 'topRate') \r\n        return false\r\n      return true\r\n    }\r\n  },\r\n\r\n  \r\n}\r\n</script>\r\n\r\n<style>\r\n@import url(//fonts.googleapis.com/earlyaccess/nanumgothic.css);\r\n  .wrapper {\r\n    position: relative;\r\n    width: 100%;\r\n    padding-bottom: 56.25%;\r\n    margin-bottom: 1vw;\r\n  }\r\n\r\n  .player {\r\n    position: absolute;\r\n    width: 100%;\r\n    height: 100%;\r\n    background: #000;\r\n  }\r\n</style>"]}]}