{"remainingRequest":"C:\\Users\\user\\Desktop\\my_project\\FinalPJT\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\user\\Desktop\\my_project\\FinalPJT\\client\\src\\components\\Modal.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"C:\\Users\\user\\Desktop\\my_project\\FinalPJT\\client\\src\\components\\Modal.vue","mtime":1622089010973},{"path":"C:\\Users\\user\\Desktop\\my_project\\FinalPJT\\client\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\user\\Desktop\\my_project\\FinalPJT\\client\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\user\\Desktop\\my_project\\FinalPJT\\client\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\user\\Desktop\\my_project\\FinalPJT\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\user\\Desktop\\my_project\\FinalPJT\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KQGltcG9ydCB1cmwoLy9mb250cy5nb29nbGVhcGlzLmNvbS9lYXJseWFjY2Vzcy9uYW51bWdvdGhpYy5jc3MpOw0KICAud3JhcHBlciB7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgIHdpZHRoOiAxMDAlOw0KICAgIHBhZGRpbmctYm90dG9tOiA1Ni4yNSU7DQogICAgbWFyZ2luLWJvdHRvbTogMXZ3Ow0KICB9DQoNCiAgLnBsYXllciB7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIHdpZHRoOiAxMDAlOw0KICAgIGhlaWdodDogMTAwJTsNCiAgICBiYWNrZ3JvdW5kOiAjMDAwOw0KICB9DQo="},{"version":3,"sources":["Modal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6NA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"Modal.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <b-modal size=\"xl\"\r\n    :id=\"'myModal'+modalName+movieId\" :title=\"movieTitle\" \r\n    @show=\"onClick\"\r\n    hide-header-close\r\n  >\r\n    <div>\r\n      <div class=\"d-flex flex-wrap justify-content-stretch\">\r\n        <!-- 영화 포스터 -->\r\n        <b-col class=\"p-3 col-12 col-lg-4\">\r\n          <img style=\"width:100%\"\r\n            :src=\"moviePoster\" :alt=\"movieTitle+'poster'\"\r\n          >\r\n        </b-col>\r\n        <b-col class=\"p-3 col-12 col-lg-8\">\r\n          <div class=\"wrapper\">\r\n            <!-- 영화 관련 -->\r\n            <iframe class=\"player\"\r\n              id=\"ytplayer\" type=\"text/html\" \r\n              :src=\"this.url\"\r\n              frameborder=\"0\">\r\n            </iframe>\r\n          </div>\r\n          <div>\r\n            <h3>\r\n              {{movieTitle}}\r\n              <b-button class=\"bg-light\" @click=\"likeToggle\" v-if=\"isNotTopRate\">\r\n                <span v-if=\"like\">\r\n                  <font-awesome-icon :icon=\"['fas','heart']\" :style=\"{color : 'red'}\" />\r\n                </span>\r\n                <span v-else>\r\n                  <font-awesome-icon :icon=\"['far','heart']\" :style=\"{color : 'black'}\"/>\r\n                </span>\r\n              </b-button>\r\n            </h3>\r\n          </div>\r\n\r\n          <div>\r\n            <p><strong>줄거리</strong></p>\r\n            <p style=\"font-family: 'Nanum Gothic', sans-serif;\">{{movieOverview}}</p>\r\n          </div>\r\n          <p><strong>개봉일:</strong> {{movieReleaseDate}}</p>\r\n          <p><strong>평점:</strong> {{movieVoteAverage}}</p>\r\n          <div v-if=\"isNotTopRate\">\r\n            <p><strong>리뷰:</strong></p>\r\n            <p v-for=\"review in reviewList\" :key=\"review.id\" \r\n              style=\"font-family: 'Nanum Gothic', sans-serif;\"> \r\n              - <a href=\"#\" @click.prevent=\"moveReview(review)\">\r\n               {{review.title}}\r\n              </a>\r\n\r\n            </p>\r\n            <button class=\"btn btn-outline-primary\" @click=\"createReview\">리뷰 작성</button>\r\n          </div>\r\n        </b-col>\r\n      </div>\r\n    </div>\r\n  </b-modal>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nconst BASE_URL = \"https://www.youtube.com/embed/\"\r\nexport default {\r\n  props:{\r\n    movie:{\r\n      type: Object,\r\n    },\r\n    modalName:{\r\n      type: String,\r\n    },\r\n  },\r\n  data(){\r\n    return {\r\n      url: '',\r\n      reviewList: [],\r\n      like: false,\r\n    }\r\n  },\r\n  methods:{\r\n    onClick(){\r\n      const movie_id = this.movie.movie_id\r\n      if(this.modalName !== 'topRate'){\r\n        axios({\r\n          method: 'get',\r\n          url:`http://127.0.0.1:8000/movies/like/${movie_id}/`,\r\n          headers: {\r\n            Authorization: `JWT ${localStorage.getItem('jwt')}`, \r\n          },\r\n        })\r\n          .then((res)=>{\r\n          if (res.data.like)\r\n            this.like = true\r\n        }).catch((e)=>{\r\n          console.log(e)\r\n        })\r\n      }\r\n\r\n      const API_KEY = '62a02e776e4bd0a23d54988aadcfde01'\r\n      const params = {\r\n        method: 'get',\r\n        url:`https://api.themoviedb.org/3/movie/${movie_id}/videos?api_key=${API_KEY}&language=ko-KR`\r\n      }\r\n      axios(params)\r\n        .then((res)=>{\r\n        const videoList = res.data.results\r\n        if (videoList.length > 0){\r\n          for (let video of videoList){\r\n            if (video.type===\"Trailer\")\r\n              this.url = BASE_URL + video.key +'?autoplay=1'\r\n            break\r\n          }\r\n          if (this.url==='')\r\n            this.url = BASE_URL + videoList[0].key +'?autoplay=1'\r\n        }\r\n        else{\r\n          const YOUTUBE_API_KEY = 'AIzaSyBMaRAd6QuQyz1vriUnV25rEYI013sLPZY'\r\n          const youtube_config = {\r\n            method: 'get',\r\n            url: 'https://www.googleapis.com/youtube/v3/search',\r\n            params:{\r\n              key: YOUTUBE_API_KEY,\r\n              part: 'snippet',\r\n              type: 'video',\r\n              q: this.movieTitle,\r\n              maxResults: 1,\r\n            }\r\n          }\r\n          axios(youtube_config)\r\n            .then((res)=>{\r\n              this.url = BASE_URL + res.data.items[0].id.videoId +'?autoplay=1'\r\n          }).catch(e=>{\r\n            console.log(e)\r\n          })\r\n        }\r\n      }).catch((e)=>{\r\n        console.log(e)\r\n      })\r\n      const params2 = { \r\n        method: 'get',\r\n        url:`http://127.0.0.1:8000/review/${movie_id}/`,\r\n        headers: {\r\n          Authorization: `JWT ${localStorage.getItem('jwt')}`, \r\n        },\r\n      }\r\n      if(this.modalName !== 'topRate'){\r\n        axios(params2)\r\n          .then((res)=>{\r\n          this.reviewList = res.data\r\n        }).catch((e)=>{\r\n          console.log(e)\r\n        })\r\n      }\r\n    },\r\n    createReview(){\r\n      this.$store.state.selectMovie = this.movie\r\n      this.$router.push({name:'CreateReview'})\r\n    },\r\n    likeToggle(){\r\n      const movie_id = this.movie.movie_id\r\n      const params = {\r\n        method: 'post',\r\n        url:`http://127.0.0.1:8000/movies/like/${movie_id}/`,\r\n        headers: {\r\n          Authorization: `JWT ${localStorage.getItem('jwt')}`, \r\n        },\r\n      }\r\n      axios(params)\r\n        .then((res)=>{\r\n        if (res.data.like)\r\n          this.like = true\r\n        else\r\n          this.like = false\r\n      }).catch((e)=>{\r\n        console.log(e)\r\n      })\r\n    },\r\n    moveReview(review){\r\n      this.$store.state.selectReview = review\r\n      this.$router.push({name: 'ReviewDetail'})\r\n    }\r\n  },\r\n  computed:{\r\n    movieTitle(){\r\n      return this.movie.title\r\n    },\r\n    movieId(){\r\n      return this.movie.movie_id\r\n    },\r\n    moviePoster(){\r\n      return \"https://image.tmdb.org/t/p/w500/\" + this.movie.poster_path\r\n    },\r\n    movieOverview(){\r\n      return this.movie.overview\r\n    },\r\n    movieReleaseDate(){\r\n      return this.movie.release_date\r\n    },\r\n    movieVoteAverage(){\r\n      return this.movie.vote_average\r\n    },\r\n    movieGenres(){\r\n      const genre_text_list = []\r\n      this.movie.genre_ids.split(',').forEach((genre)=>{\r\n        if (genre)\r\n          genre_text_list.push(this.$store.state.genres[Number(genre)])\r\n      })\r\n      return genre_text_list.join(', ')\r\n    },\r\n    isNotTopRate(){\r\n      if (this.modalName === 'topRate') \r\n        return false\r\n      return true\r\n    }\r\n  },\r\n\r\n  \r\n}\r\n</script>\r\n\r\n<style>\r\n@import url(//fonts.googleapis.com/earlyaccess/nanumgothic.css);\r\n  .wrapper {\r\n    position: relative;\r\n    width: 100%;\r\n    padding-bottom: 56.25%;\r\n    margin-bottom: 1vw;\r\n  }\r\n\r\n  .player {\r\n    position: absolute;\r\n    width: 100%;\r\n    height: 100%;\r\n    background: #000;\r\n  }\r\n</style>\r\n"]}]}